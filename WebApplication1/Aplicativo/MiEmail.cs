using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Mail;
using System.Text;
using System.Web;

namespace WebApplication1.Aplicativo
{
    public class MiEmail
    {
        public enum tipo_mail
        {
            validacion,
            notificacion,
            recupero_contraseña
        }

        public MiEmail(Envio_mail mail)
        {
            using (HabProfDBContainer cxt = new Aplicativo.HabProfDBContainer())
            {
                Persona p = cxt.Personas.FirstOrDefault(pp => pp.persona_id == mail.persona_id);
                Tipo_mail = (tipo_mail) Enum.Parse(typeof(tipo_mail), mail.envio_tipo);
                Smtp_client = p.Licenciatura.Servidor.servidor_smtp_host;
                Smtp_puerto = p.Licenciatura.Servidor.servidor_smtp_port;
                Persona_nombre = p.persona_nomyap;
                Url_respuesta = "http://localhost:60142/landing_mail.aspx?tipo_mail=" + mail.envio_tipo + "&clave=" + mail.envio_respuesta_clave;
                Credenciales_mail = p.Licenciatura.licenciatura_email;
                Credenciales_contraseña = p.Licenciatura.licenciatura_email_clave;
                Destinatarios = new List<string>(mail.envio_email_destino.Replace(" ", "").Split(','));
                switch (Tipo_mail)
                {
                    case tipo_mail.validacion:
                        Asunto = "Sistema de administración de Tesis - Validación de correo";
                        break;
                    case tipo_mail.notificacion:
                        Asunto = "Sistema de administración de Tesis - Notificación";
                        break;
                    case tipo_mail.recupero_contraseña:
                        Asunto = "Sistema de administración de Tesis - Recuperar contraseña";
                        break;
                    default:
                        break;
                }
            }
        }

        public tipo_mail Tipo_mail { get; set; }

        private string cuerpo;

        public List<string> Destinatarios { get; set; }

        public string Credenciales_mail { get; set; }

        public string Credenciales_contraseña { get; set; }

        public string Asunto { get; set; }

        public string Smtp_client { get; set; }

        public int Smtp_puerto { get; set; }

        private string dir_imagen = "../images/utn.png";

        public string Persona_nombre { get; set; }

        public string Url_respuesta { get; set; }

        private string Cargar_cuerpo_validacion(string dir_imagen, string persona_nombre, string url_respuesta)
        {
            StringBuilder sb = new StringBuilder();
            sb.AppendLine("<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"><head>																																																																																																														");
            sb.AppendLine("    <!--[if gte mso 9]><xml>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("     <o:OfficeDocumentSettings>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("      <o:AllowPNG/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("      <o:PixelsPerInch>96</o:PixelsPerInch>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("     </o:OfficeDocumentSettings>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    </xml><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("    <meta name=\"viewport\" content=\"width=device-width\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("    <!--[if !mso]><!--><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    <title></title>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    <style type=\"text/css\" id=\"media-query\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("      body {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  margin: 0;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  padding: 0; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("table, tr, td {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("  vertical-align: top;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("  border-collapse: collapse; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser table, .mso-container table {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("  table-layout: fixed; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("* {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("  line-height: inherit; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("a[x-apple-data-detectors=true] {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("  color: inherit !important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  text-decoration: none !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("[owa] .img-container div, [owa] .img-container button {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("  display: block !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("[owa] .fullwidth button {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("  width: 100% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("[owa] .block-grid .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  display: table-cell;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("  float: none !important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("  vertical-align: top; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  width: 500px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("  line-height: 100%; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  width: 164px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  width: 328px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("  width: 250px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  width: 166px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("  width: 125px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("  width: 100px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("  width: 83px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  width: 71px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  width: 62px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("  width: 55px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("  width: 50px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  width: 45px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine(".ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  width: 41px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("@media only screen and (min-width: 520px) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("  .block-grid {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("    width: 500px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("    vertical-align: top; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("    .block-grid .col.num12 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("      width: 500px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("  .block-grid.mixed-two-up .col.num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("    width: 164px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.mixed-two-up .col.num8 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("    width: 328px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.two-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("    width: 250px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.three-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    width: 166px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.four-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    width: 125px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.five-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    width: 100px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  .block-grid.six-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("    width: 83px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.seven-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    width: 71px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.eight-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    width: 62px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.nine-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    width: 55px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.ten-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("    width: 50px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.eleven-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("    width: 45px !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  .block-grid.twelve-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("    width: 41px !important; } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("@media (max-width: 520px) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("  .block-grid, .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("    min-width: 320px !important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    max-width: 100% !important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("    display: block !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("  .block-grid {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("    width: calc(100% - 40px) !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("    width: 100% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    .col > div {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("      margin: 0 auto; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("  img.fullwidth, img.fullwidthOnMobile {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("    max-width: 100% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("  .no-stack .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("    min-width: 0 !important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    display: table-cell !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("  .no-stack.two-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("    width: 50% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  .no-stack.mixed-two-up .col.num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("    width: 33% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  .no-stack.mixed-two-up .col.num8 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("    width: 66% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  .no-stack.three-up .col.num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    width: 33% !important; }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("  .no-stack.four-up .col.num3 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("    width: 25% !important; } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    </style>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("</head>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("<body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #FFFFFF\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("  <style type=\"text/css\" id=\"media-query-bodytag\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("    @media (max-width: 520px) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("      .block-grid {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("        min-width: 320px!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("        max-width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("        width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("        display: block!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("      }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("      .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("        min-width: 320px!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("        max-width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("        width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("        display: block!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("      }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("        .col > div {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("          margin: 0 auto;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("        }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("      img.fullwidth {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("        max-width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("      }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("			img.fullwidthOnMobile {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("        max-width: 100%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("      }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("      .no-stack .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("				min-width: 0!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("				display: table-cell!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("			.no-stack.two-up .col {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ");
            sb.AppendLine("				width: 50%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("			.no-stack.mixed-two-up .col.num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("				width: 33%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("			.no-stack.mixed-two-up .col.num8 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("				width: 66%!important;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("			.no-stack.three-up .col.num4 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("				width: 33%!important                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("			.no-stack.four-up .col.num3 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("				width: 25%!important                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("			}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("  </style>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  <!--[if IE]><div class=\"ie-browser\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("  <!--[if mso]><div class=\"mso-container\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #FFFFFF;width: 100%\" cellpadding=\"0\" cellspacing=\"0\">                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("	<tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("	<tr style=\"vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("		<td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("    <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td align=\"center\" style=\"background-color: #FFFFFF;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("    <div style=\"background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("      <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("        <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("          <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"background-color:transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width: 500px;\"><tr class=\"layout-full-width\" style=\"background-color:transparent;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (mso)|(IE)]><td align=\"center\" width=\"500\" style=\" width:500px; padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;\" valign=\"top\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("            <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("              <div style=\"background-color: transparent; width: 100% !important;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--><div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\"><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <!--[if mso]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("<div style=\"color:#555555;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("	<div style=\"font-size:12px;line-height:14px;color:#555555;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;text-align:left;\"><p style=\"margin: 0;font-size: 12px;line-height: 14px;text-align: center\"><span style=\"font-size: 26px; line-height: 31px;\">Sistema de administración de Tesinas</span></p><p style=\"margin: 0;font-size: 12px;line-height: 14px;text-align: center\"><span style=\"font-size: 18px; line-height: 21px;\">Validación de e-mail</span></p></div>	                                                                                                                                                                                                                                ");
            sb.AppendLine("</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("<!--[if mso]></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"divider\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 100%;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("    <tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("        <tr style=\"vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("            <td class=\"divider_inner\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top;padding-right: 10px;padding-left: 10px;padding-top: 10px;padding-bottom: 10px;min-width: 100%;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                <table class=\"divider_content\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;border-top: 1px solid #BBBBBB;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("                    <tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                        <tr style=\"vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("                            <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("                                <span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("                            </td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("                        </tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("                    </tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                </table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("            </td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("        </tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    </tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("</table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("              </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("            </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("          <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("      </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    </div>    <div style=\"background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("      <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid mixed-two-up \">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("        <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("          <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"background-color:transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width: 500px;\"><tr class=\"layout-full-width\" style=\"background-color:transparent;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (mso)|(IE)]><td align=\"center\" width=\"167\" style=\" width:167px; padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;\" valign=\"top\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("            <div class=\"col num4\" style=\"display: table-cell;vertical-align: top;max-width: 320px;min-width: 164px;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("              <div style=\"background-color: transparent; width: 100% !important;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--><div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\"><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <div align=\"center\" class=\"img-container center  autowidth  fullwidth\" style=\"padding-right: 0px;  padding-left: 0px;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("<!--[if mso]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding-right: 0px; padding-left: 0px;\" align=\"center\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  <img class=\"center  autowidth  fullwidth\" align=\"center\" border=\"0\" src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/UTN_logo.jpg/240px-UTN_logo.jpg\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: 0;height: auto;float: none;width: 100%;max-width: 166.666666666667px\" width=\"166.666666666667\">                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("<!--[if mso]></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("              </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("            </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("              <!--[if (mso)|(IE)]></td><td align=\"center\" width=\"333\" style=\" width:333px; padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;\" valign=\"top\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("            <div class=\"col num8\" style=\"display: table-cell;vertical-align: top;min-width: 320px;max-width: 328px;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ");
            sb.AppendLine("              <div style=\"background-color: transparent; width: 100% !important;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--><div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\"><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <!--[if mso]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("<div style=\"color:#555555;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("	<div style=\"font-size:12px;line-height:14px;color:#555555;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;text-align:left;\"><p style=\"margin: 0;font-size: 14px;line-height: 17px\">Hola <strong>" + persona_nombre + "</strong>, hemos recibido el pedido de validación de e-mail, si ha sido&#160;fue usted el que solicitó, para completar el proceso deberá hacer click en el siguiente botón:</p></div>	                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("<!--[if mso]></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("<div align=\"left\" class=\"button-container left\" style=\"padding-right: 10px; padding-left: 10px; padding-top:10px; padding-bottom:10px;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("  <!--[if mso]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-spacing: 0; border-collapse: collapse; mso-table-lspace:0pt; mso-table-rspace:0pt;\"><tr><td style=\"padding-right: 10px; padding-left: 10px; padding-top:10px; padding-bottom:10px;\" align=\"left\"><v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"" + url_respuesta + "\" style=\"height:31pt; v-text-anchor:middle; width:102pt;\" arcsize=\"10%\" strokecolor=\"#3AAEE0\" fillcolor=\"#3AAEE0\"><w:anchorlock/><v:textbox inset=\"0,0,0,0\"><center style=\"color:#ffffff; font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size:16px;\"><![endif]-->  ");
            sb.AppendLine("    <a href=\"" + Url_respuesta + "\" target=\"_blank\" style=\"display: block;text-decoration: none;-webkit-text-size-adjust: none;text-align: center;color: #ffffff; background-color: #3AAEE0; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; max-width: 166px; width: 126px;width: auto; border-top: 0px solid transparent; border-right: 0px solid transparent; border-bottom: 0px solid transparent; border-left: 0px solid transparent; padding-top: 5px; padding-right: 20px; padding-bottom: 5px; padding-left: 20px; font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;mso-border-alt: none\">                                                                                         ");
            sb.AppendLine("      <span style=\"font-size:16px;line-height:32px;\">Validar e-mail &gt;&gt;</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ");
            sb.AppendLine("    </a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("  <!--[if mso]></center></v:textbox></v:roundrect></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("              </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("            </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("          <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("      </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    </div>    <div style=\"background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("      <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("        <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("          <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"background-color:transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width: 500px;\"><tr class=\"layout-full-width\" style=\"background-color:transparent;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (mso)|(IE)]><td align=\"center\" width=\"500\" style=\" width:500px; padding-right: 0px; padding-left: 0px; padding-top:5px; padding-bottom:5px; border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent;\" valign=\"top\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("            <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("              <div style=\"background-color: transparent; width: 100% !important;\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--><div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\"><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" class=\"divider\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 100%;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("    <tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("        <tr style=\"vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("            <td class=\"divider_inner\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top;padding-right: 10px;padding-left: 10px;padding-top: 10px;padding-bottom: 10px;min-width: 100%;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                <table class=\"divider_content\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;border-top: 1px solid #BBBBBB;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("                    <tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                        <tr style=\"vertical-align: top\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("                            <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top;mso-line-height-rule: exactly;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%\">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("                                <span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("                            </td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("                        </tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("                    </tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("                </table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("            </td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ");
            sb.AppendLine("        </tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("    </tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("</table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                    <!--[if mso]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\"><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("<div style=\"color:#555555;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif; padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("	<div style=\"font-size:12px;line-height:14px;text-align:left;color:#555555;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;\"><p style=\"margin: 0;font-size: 12px;line-height: 14px;text-align: left\">Un saludo, el equipo de desarrollo de la materia Habilitación Profesional - 2018</p></div>	                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ");
            sb.AppendLine("<!--[if mso]></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("              <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("              </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ");
            sb.AppendLine("            </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ");
            sb.AppendLine("          <!--[if (mso)|(IE)]></td></tr></table></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");
            sb.AppendLine("      </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ");
            sb.AppendLine("    </div>   <!--[if (mso)|(IE)]></td></tr></table><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ");
            sb.AppendLine("		</td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ");
            sb.AppendLine("  </tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ");
            sb.AppendLine("  </tbody>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  </table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ");
            sb.AppendLine("  <!--[if (mso)|(IE)]></div><![endif]-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ");
            sb.AppendLine("</body></html>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ");

            string ret = sb.ToString().Replace("\\","");
            return ret;

        }


        public bool Enviar_mail()
        {
            try
            {
                
                switch (this.Tipo_mail)
                {
                    case tipo_mail.validacion:
                        cuerpo = Cargar_cuerpo_validacion(dir_imagen, Persona_nombre, Url_respuesta);
                        break;
                    case tipo_mail.notificacion:
                        break;
                    case tipo_mail.recupero_contraseña:
                        break;
                    default:
                        break;
                }
               
                var msg = new MailMessage(Credenciales_mail, Destinatarios[0], Asunto, cuerpo);
               
                for (int i = 1; i < Destinatarios.Count; i++)
                {
                    msg.To.Add(Destinatarios[i]);
                }

                msg.IsBodyHtml = true;

                var smtpClient = new SmtpClient(Smtp_client, Smtp_puerto);
                smtpClient.UseDefaultCredentials = true;
                smtpClient.Credentials = new NetworkCredential(Credenciales_mail, Credenciales_contraseña);
                smtpClient.EnableSsl = true;
                smtpClient.Send(msg);

                return true;
            }
            catch(Exception ex)
            {
                return false;
            }
        }

    }
}